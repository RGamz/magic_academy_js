/* =========================
   Variables & base reset
   ========================= */
:root{
  --bg:#f6f7fb;
  --card:#ffffff;
  --text:#111;
  --muted:#666;
  --primary:#4b7cff;
  --pill:#e8f0ff;
  --border:#e6e7ec;
  --radius:14px;
  --shadow:0 6px 20px rgba(0,0,0,.06);
  --container:clamp(960px,92vw,1680px);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:var(--bg);
  color:var(--text);
  line-height:1.45;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}
img{max-width:100%;display:block}

/* =========================
   A11y helpers
   ========================= */
.skip-link{
  position:absolute;left:-999px;top:auto;width:1px;height:1px;overflow:hidden;
}
.skip-link:focus{
  left:12px;top:12px;width:auto;height:auto;padding:8px 12px;
  background:#000;color:#fff;border-radius:8px;z-index:1000;
}
.sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}

/* =========================
   Layout / header / nav
   ========================= */
.container{max-width:var(--container);margin:0 auto;padding:16px}
.header-container{
  display:flex;align-items:center;gap:12px;padding:0;
}
.site-header{
  background:var(--card);
  border-bottom:1px solid var(--border);
  position:sticky;top:0;z-index:10;
}
.brand{margin:0;font-size:1.2rem}
.site-nav{display:flex;gap:12px;align-items:center}
.site-nav a{
  color:var(--text);text-decoration:none;
  padding:8px 10px;border-radius:8px;
}
.site-nav a[aria-current="page"]{background:var(--pill)}

/* =========================
   Home: cards
   ========================= */
.hero h2{margin:0 0 4px}
.muted,.mute{color:var(--muted)}

.card-grid{
  display:grid;gap:16px;margin-top:16px;
  grid-template-columns:repeat(3,1fr);
}
.card{
  background:var(--card);border:1px solid var(--border);
  border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;
}
.card-link{display:block;color:inherit;text-decoration:none;height:100%}
.card-media{position:relative;aspect-ratio:16/9;overflow:hidden}
.card-media img{width:100%;height:100%;object-fit:cover}
.pill{
  position:absolute;left:10px;top:10px;
  background:var(--pill);padding:6px 10px;border-radius:999px;font-size:.8rem;
}
.card-body{padding:12px 14px}
.card-body h4{margin:0 0 6px;font-size:1rem}

/* =========================
   Lesson layout
   ========================= */
.lesson-layout{
  display:grid;gap:16px;align-items:start;
  grid-template-columns:2fr 1fr;
}
.lesson-media{width:100%}
.lesson-side{position:relative}

.panel{
  position:sticky;top:84px;
  background:var(--card);border:1px solid var(--border);
  border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;
}

/* main illustration: max size w/o cropping */
.media-wrap{
  margin:0;background:#fff;border-radius:var(--radius);
  overflow:hidden;box-shadow:var(--shadow);border:1px solid var(--border);
  display:flex;align-items:center;justify-content:center;
}
.media-large{
  width:100%;height:auto;display:block;
  max-height:min(84vh,1400px);
  object-fit:contain;
}

/* =========================
   Tasks (details/summary)
   ========================= */
.task{
  border:1px solid var(--border);
  border-radius:var(--radius);
  background:var(--card);
  box-shadow:var(--shadow);
  margin:10px 0;overflow:hidden;
}
.task + .task{margin-top:16px}

.task-summary{
  list-style:none;cursor:pointer;
  display:flex;align-items:center;padding:0;
}
.task-summary::-webkit-details-marker{display:none}
.task-summary::before{
  content:"â–¸";display:inline-block;margin:0 8px 0 12px;
  transform:translateY(2px);transition:transform .2s ease;color:var(--muted);font-size:1rem;
}
.task[open] .task-summary::before{transform:rotate(90deg) translateX(-1px)}

.bubble{
  background:var(--pill);
  border-radius:12px;
  padding:12px;margin:8px 12px 10px;
}
.task-body{padding:0 12px 12px}
.text p{margin:0 0 6px}

.sep{border:none;border-top:1px solid var(--border);margin:14px 0}

/* =========================
   Buttons & utils
   ========================= */
.row{display:flex;gap:10px;flex-wrap:wrap}
.btn{
  appearance:none;border:1px solid var(--border);background:#fff;
  padding:10px 14px;border-radius:10px;cursor:pointer;
}
.btn:hover{border-color:var(--primary)}
.btn.ghost{background:transparent}
.hidden{display:none}
.w100{width:100%}

/* =========================
   Skeleton placeholders
   ========================= */
.skeleton .card-media{background:#eee;height:0;padding-bottom:56%}
.skeleton-line{height:14px;background:#eee;border-radius:8px;margin:8px 0}
.skeleton-line.short{width:60%}

/* =========================
   Media queries
   ========================= */
@media (min-width:1600px){
  .card-grid{grid-template-columns:repeat(4,1fr)}
}
@media (min-width:1400px){
  .lesson-layout{grid-template-columns:2.5fr 1fr}
}
@media (min-width:1800px){
  .lesson-layout{grid-template-columns:3fr 1fr}
}
@media (max-width:1024px){
  .card-grid{grid-template-columns:repeat(2,1fr)}
}
@media (max-width:800px){
  .lesson-layout{grid-template-columns:1fr}
  .panel{position:static}
}
@media (max-width:640px){
  .task .bubble{margin:8px;width:calc(100% - 16px)}
  .task-body{padding:0 8px 10px}
}

/* =========================
   Reduced motion
   ========================= */
@media (prefers-reduced-motion:reduce){
  *{scroll-behavior:auto;animation:none;transition:none}
}
.task[open] .task-body{animation:fadeIn .16s ease-out}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(-2px)}
  to{opacity:1;transform:translateY(0)}
}

.game_section {
  display: flex;
  justify-content: center;
}